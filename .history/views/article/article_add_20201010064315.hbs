{{!< main}}

{{#if err}}
<div class="ui error message">
  <i class="close icon"></i>
  <div class="header">
    Errors
  </div>
  <ul class="list">
    {{#each err}}
    <li>{{message}}</li>
    {{/each}}
  </ul>
</div>
{{/if}}

<form class="ui form" method="POST" action="/article/add" enctype="multipart/form-data">
  <div class="field">
    <label>Title</label>
    <input type="text" name="title" placeholder="Title">
    <br>
    <br>
    <label>Text</label>
    <textarea name="text" placeholder="Text">
  </textarea>
  </div>
  <div class="field">
    <label>File</label>
  </div>
  <input id="imageInput" name="image" type="file" multiple>
  <img class="tiny" id="blah" src="#" alt="your image" />
  {{!-- <input type="file" name="image" value="noimage.jpg"> --}}


  <br><br>
  <button class="ui button" type="submit">Submit</button>
</form>


<article>
    <label for="files">Select multiple files:</label>
    <input id="files" type="file" multiple="multiple" />
    <output id="result" />
</article>


<div id="imgarea">

</div>

<script>
  function readURL(input) {


    if (input.files && input.files[0]) {

      let reader = new FileReader();

      for (key in input.files) {

        var img = $(`<img id="${key}" class="ui small image">`); //Equivalent: $(document.createElement('img'))
        img.appendTo('#imgarea');

        reader.onload = (e) => {
          $(`#${key}`).attr('src', e.target.result);
        }

        reader.readAsDataURL(input.files[key]); // convert to base64 string
      }

    }
  }

  $("#imageInput").change(function () {
    readURL(this);
  });
</script>

<script>
  function handleFileSelect() {
  // Check File API support
  if (window.File && window.FileList && window.FileReader) {
    const { files } = event.target; // FileList object
    const output = document.getElementById('result');

    for (let i = 0; i < files.length; i++) {
      const file = files[i];
      // Only pics
      if (!file.type.match('image')) continue;

      const picReader = new FileReader();
      picReader.addEventListener('load', (event) => {
        const picFile = event.target;
        const div = document.createElement('div');
        div.innerHTML = `<img class='thumbnail' src='${picFile.result}'` + `title='${picFile.name}'/>`;
        output.insertBefore(div, null);
      });
      // Read the image
      picReader.readAsDataURL(file);
    }
  } else {
    console.log('Your browser does not support File API');
  }
}

document.getElementById('files').addEventListener('change', handleFileSelect, false);

</script>