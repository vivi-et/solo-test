{{!< main}}
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

<form class="ui form" action="/design/add" method="POST">
  <div class="order_list">
    <h1>Add Product</h1>
    <br>
    {{!-- <input type="file" name="image_main" placeholder="main image"> --}}
    <br>
    <br>
    Category 1
    <br><br>

    <div class="fields">
      <div class="field">
        <label>Category 1</label>
        <select data-item="1" class="ui search dropdown" name="category1">
          <option value="category1_A1">category1_A1</option>
          <option value="category1_A2">category1_A2</option>
        </select>
      </div>
      <div class="field">
        <label>Category 2</label>
        <select data-item="1" class="ui search dropdown" name="category2">
          <option value="category2_A1">1.category2_A1</option>
          <option value="category2_A2">2.category2_A2</option>
          <option value="category2_A3">3.category2_A3</option>
          <option value="category2_A4">4.category2_A4</option>
        </select>
      </div>
      <div class="field" id="category3">
        <label>Category 3</label>
        <select data-item="1" class="ui search dropdown" name="category3">
          <option value="category3_A1">1.category3_A1</option>
          <option value="category3_A2">2.category3_A2</option>
          <option value="category3_A3">3.category3_A3</option>
          <option value="category3_A4">4.category3_A4</option>
        </select>
      </div>
    </div>

    <div class="field">
      <input data-item="1" type="text" placeholder="design_name" name="design_name">
    </div>

    <select data-item="1" multiple="" class="ui fluid dropdown" name="skills">
      <option value="1">design_name1_A1</option>
      <option value="2">design_name1_A2</option>
      <option value="3">design_name1_A3</option>
      <option value="4">design_name1_A4</option>

    </select>
    <br><br>
  </div>
  <button type="submit">submit</button>
</form>
<br><br>
<button class="ui green large button" onclick="addform()">+</button>
<button onclick="test()">TEST</button>
<script>

  const formsLimit = 5;
  let forms = 1;

  (function ($, undefined) {
    '$:nomunge'; // Used by YUI compressor.
    $.fn.serializeObject = function () {
      var obj = {};
      $.each(this.serializeArray(), function (i, o) {
        var n = o.name,
          v = o.value;
        obj[n] = obj[n] === undefined ? v
          : $.isArray(obj[n]) ? obj[n].concat(v)
            : [obj[n], v];
      });
      return obj;
    };
  })(jQuery);

  function test() {

    const dataArr = [];
    for (let i = 0; i < forms; i++) {
      console.log(i);

      let formData = $(`[data-item="${i + 1}"]`).serializeObject();



      dataArr.push(formData);


    }

    console.log(dataArr);
    axios.post('/test', {
      data: dataArr
    })
      .then((response) => {

        const { data } = response;
        console.log('axois response ', data);
      })
      .catch((error) => {
        console.log(error);
      });


  }
  function tem() {

    axios.post('/test', {
      data: dataArr
    })
      .then((response) => {

        const { data } = response;
        console.log('axois response ', data);
      })
      .catch((error) => {
        console.log(error);
      });

  }

  $(document).ready(function () {
    $('.ui.dropdown')
      .dropdown();
  });

  function addform() {
    forms += 1;
    console.log(forms);

    if (forms > formsLimit) {
      forms = formsLimit
      return alert(`${forms} only!`);
    }

    const html = `{{> form}}`;


    $('.order_list').append(html)
    $('.ui.dropdown').dropdown();
  }


</script>